<!DOCTYPE html>
<html>
    <head>
        <title>Superhero Language Learner</title>
        <link rel="stylesheet" href="marvel_theme.css"/>
    </head>
    <body>
        <h1>Log In</h1>
        <form>
            Email: <input type="text" id="email" name="email" placeholder="Email"/> <br />
            Password: <input type="password" id="password" name="password" placeholder="Password"/> <br />
            <button id="log-in-button">Log In</button>
        </form>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyDASOXphdfPFUK6mdYDTlhqnXmu-WNJQZs",
                authDomain: "hacktech2018-4d204.firebaseapp.com",
                databaseURL: "https://hacktech2018-4d204.firebaseio.com",
                projectId: "hacktech2018-4d204",
                storageBucket: "hacktech2018-4d204.appspot.com",
                messagingSenderId: "88807207497"
            };
            firebase.initializeApp(config);
        </script>
        <script>
            // HANDLES LOG IN BUTTON CLICK
            function logIn() {
                var email = $('#email').val();
                var password = $('#password').val();
                if (email.length < 4) {
                    alert('Please enter an email address.');
                    return;
                }
                if (password.length < 4) {
                    alert('Please enter a password.');
                    return;
                }
                console.log('going to signin')
                // Sign in with email and pass.
                firebase.auth().signInWithEmailAndPassword(email, password)
                .then(function(data) {
                    console.log('boi')
                    console.log(data);
                    window.location.replace("progress.html");
                })
                .catch(function(error) {
                    // Handle Errors here.
                    var errorCode = error.code;
                    var errorMessage = error.message;
                    if (errorCode === 'auth/wrong-password') {
                        alert('Your password was incorrect. Please try again.');
                        return;
                    } else {
                        alert(errorMessage);
                        return;
                    }
                    console.log(error);
                });
            }
            $(window).on("load", function() {
                console.log("window loaded");
                if (firebase.auth().currentUser) {
                    console.log("currentUser in");
                    window.location.replace("progress.html");
                }
            });
            $("#log-in-button").on("click", logIn);
        </script>
    </body>
</html>